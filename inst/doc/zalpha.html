<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>zalpha</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">zalpha</h1>



<p>The zalpha package contains statistics for identifying areas of the genome that have undergone a selective sweep. The idea behind these statistics is to find areas of the genome that are highly correlated, as this can be a sign that a sweep has occurred recently in the vicinity. For more information on the statistics, please see the paper by Jacobs et al. (2016) referenced below.</p>
<div id="data" class="section level2">
<h2>Data</h2>
<p>The data used in this vignette is a very small simple dataset containing 20 SNPs and a population of 10 chromosomes. Realistically, the dataset would be much bigger. It is highly recommended to use only SNPs with a minor allele frequency of over 5%, as it is hard to find correlations between rare alleles.</p>
<p>The dataset “snps” is included with this package and can be loaded using the code:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(zalpha)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">data</span>(snps)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="co">## This is what the dataset looks like:</span></a>
<a class="sourceLine" id="cb1-4" title="4">snps</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="co">#&gt;    positions distances chrom_1 chrom_2 chrom_3 chrom_4 chrom_5 chrom_6 chrom_7</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co">#&gt; 1        100    0.0001       1       0       0       1       1       1       0</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co">#&gt; 2        200    0.0002       1       1       1       0       0       0       1</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co">#&gt; 3        300    0.0005       1       1       1       1       1       1       1</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="co">#&gt; 4        400    0.0008       0       0       1       1       1       0       1</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="co">#&gt; 5        500    0.0010       1       1       1       1       0       1       0</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="co">#&gt; 6        600    0.0015       1       0       0       1       1       0       1</span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="co">#&gt; 7        700    0.0017       1       0       0       1       1       1       1</span></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="co">#&gt; 8        800    0.0019       0       0       0       0       1       1       1</span></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="co">#&gt; 9        900    0.0023       1       1       0       0       1       1       0</span></a>
<a class="sourceLine" id="cb1-15" title="15"><span class="co">#&gt; 10      1000    0.0024       0       0       1       1       0       0       1</span></a>
<a class="sourceLine" id="cb1-16" title="16"><span class="co">#&gt; 11      1100    0.0026       1       0       1       0       0       0       0</span></a>
<a class="sourceLine" id="cb1-17" title="17"><span class="co">#&gt; 12      1200    0.0027       1       0       1       0       1       0       0</span></a>
<a class="sourceLine" id="cb1-18" title="18"><span class="co">#&gt; 13      1300    0.0032       1       1       1       1       0       0       1</span></a>
<a class="sourceLine" id="cb1-19" title="19"><span class="co">#&gt; 14      1400    0.0037       1       0       1       0       1       0       0</span></a>
<a class="sourceLine" id="cb1-20" title="20"><span class="co">#&gt; 15      1500    0.0039       0       0       1       0       1       0       0</span></a>
<a class="sourceLine" id="cb1-21" title="21"><span class="co">#&gt; 16      1600    0.0040       1       0       0       0       0       1       1</span></a>
<a class="sourceLine" id="cb1-22" title="22"><span class="co">#&gt; 17      1700    0.0041       0       0       0       1       0       1       1</span></a>
<a class="sourceLine" id="cb1-23" title="23"><span class="co">#&gt; 18      1800    0.0045       1       0       1       0       0       0       1</span></a>
<a class="sourceLine" id="cb1-24" title="24"><span class="co">#&gt; 19      1900    0.0048       1       0       0       1       1       1       0</span></a>
<a class="sourceLine" id="cb1-25" title="25"><span class="co">#&gt; 20      2000    0.0049       0       1       1       0       0       1       1</span></a>
<a class="sourceLine" id="cb1-26" title="26"><span class="co">#&gt;    chrom_8 chrom_9 chrom_10</span></a>
<a class="sourceLine" id="cb1-27" title="27"><span class="co">#&gt; 1        0       0        0</span></a>
<a class="sourceLine" id="cb1-28" title="28"><span class="co">#&gt; 2        0       1        0</span></a>
<a class="sourceLine" id="cb1-29" title="29"><span class="co">#&gt; 3        1       0        1</span></a>
<a class="sourceLine" id="cb1-30" title="30"><span class="co">#&gt; 4        1       0        0</span></a>
<a class="sourceLine" id="cb1-31" title="31"><span class="co">#&gt; 5        0       1        0</span></a>
<a class="sourceLine" id="cb1-32" title="32"><span class="co">#&gt; 6        0       0        1</span></a>
<a class="sourceLine" id="cb1-33" title="33"><span class="co">#&gt; 7        1       1        0</span></a>
<a class="sourceLine" id="cb1-34" title="34"><span class="co">#&gt; 8        1       0        1</span></a>
<a class="sourceLine" id="cb1-35" title="35"><span class="co">#&gt; 9        0       1        1</span></a>
<a class="sourceLine" id="cb1-36" title="36"><span class="co">#&gt; 10       1       1        1</span></a>
<a class="sourceLine" id="cb1-37" title="37"><span class="co">#&gt; 11       0       1        0</span></a>
<a class="sourceLine" id="cb1-38" title="38"><span class="co">#&gt; 12       1       1        1</span></a>
<a class="sourceLine" id="cb1-39" title="39"><span class="co">#&gt; 13       1       1        0</span></a>
<a class="sourceLine" id="cb1-40" title="40"><span class="co">#&gt; 14       1       0        1</span></a>
<a class="sourceLine" id="cb1-41" title="41"><span class="co">#&gt; 15       1       1        0</span></a>
<a class="sourceLine" id="cb1-42" title="42"><span class="co">#&gt; 16       1       0        1</span></a>
<a class="sourceLine" id="cb1-43" title="43"><span class="co">#&gt; 17       1       0        1</span></a>
<a class="sourceLine" id="cb1-44" title="44"><span class="co">#&gt; 18       1       1        0</span></a>
<a class="sourceLine" id="cb1-45" title="45"><span class="co">#&gt; 19       0       0        1</span></a>
<a class="sourceLine" id="cb1-46" title="46"><span class="co">#&gt; 20       0       0        1</span></a></code></pre></div>
<p>This data set contains information about each of the SNPs. The first column gives the physical location of the SNP along the chromosome, in whatever units is useful to the user (usually bp or Kb). In this example, the positions are assumed to be in base pairs (bp).</p>
<p>The next column is the genetic distance of the SNP from the start of the chromosome. This could be in centimorgans (cM), linkage disequilibrium units (LDU) or any other way of measuring genetic distance, as long as it is additive (i.e. the distance between SNP A and SNP C is equal to the distance between SNP A and SNP B plus SNP B and SNP C). This data is only required if the user is interested in adjusting for recombination and supplies an LDprofile.</p>
<p>The final columns are the SNP alleles for each of the chromosomes in the population. Each SNP must be biallelic, but can contain any value, for example 0s and 1s, or A/G/C/Ts.</p>
</div>
<div id="zalpha" class="section level2">
<h2>Zalpha</h2>
<p>To test for selection, the user can use the Zalpha function. This function takes each SNP in the dataset, the “target locus”, calculates the <span class="math inline">\(Z_{\alpha}\)</span> value, then moves on to the next SNP. It works by calculating correlations between alleles on each side of the target locus and averaging them. To do this, the function needs three inputs:</p>
<ul>
<li><p>A vector of the physical locations of each of the SNPs</p></li>
<li><p>The window size. This is set to 3000 for this small example but realistically a window size of around 200 Kb is appropriate. The window is centred on the target locus, and considers SNPs that are within ws/2 to the left and ws/2 to the right of the target SNP.</p></li>
<li><p>A matrix of the SNP alleles across each chromosome in the sample. The number of rows should be equal to the number of SNPs, and the columns are each of the chromosomes.</p></li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">results&lt;-<span class="kw">Zalpha</span>(snps<span class="op">$</span>positions,<span class="dv">3000</span>,<span class="kw">as.matrix</span>(snps[,<span class="dv">3</span><span class="op">:</span><span class="dv">12</span>]))</a>
<a class="sourceLine" id="cb2-2" title="2">results</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="co">#&gt; $position</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co">#&gt;  [1]  100  200  300  400  500  600  700  800  900 1000 1100 1200 1300 1400 1500</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co">#&gt; [16] 1600 1700 1800 1900 2000</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co">#&gt; $Zalpha</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="co">#&gt;  [1]         NA         NA         NA         NA 0.09893585 0.10944106</span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co">#&gt;  [7] 0.11602964 0.11215782 0.12419556 0.12962040 0.12583275 0.11980489</span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co">#&gt; [13] 0.10802033 0.12064462 0.10873917 0.10267168         NA         NA</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co">#&gt; [19]         NA         NA</span></a>
<a class="sourceLine" id="cb2-12" title="12"><span class="kw">plot</span>(results<span class="op">$</span>position,results<span class="op">$</span>Zalpha)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The output shows the positions of each of the SNPs and the <span class="math inline">\(Z_{\alpha}\)</span> value calculated for each SNP. The NAs are due to the parameters minRandL and minRL, which have defaults 4 and 25 respectively. minRandL specifies the minimum number of SNPs that must be to the left and right of the target SNP within the window. minRL is the product of these numbers.</p>
<p>Say the user is only interested in the output of Zalpha for a particular region of the chromosome; this is achieved by setting the “X” parameter to the lower and upper bounds of the region.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">Zalpha</span>(snps<span class="op">$</span>positions,<span class="dv">3000</span>,<span class="kw">as.matrix</span>(snps[,<span class="dv">3</span><span class="op">:</span><span class="dv">12</span>]),<span class="dt">X=</span><span class="kw">c</span>(<span class="dv">500</span>,<span class="dv">1000</span>))</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="co">#&gt; $position</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="co">#&gt; [1]  500  600  700  800  900 1000</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co">#&gt; $Zalpha</span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">#&gt; [1] 0.09893585 0.10944106 0.11602964 0.11215782 0.12419556 0.12962040</span></a></code></pre></div>
</div>
<div id="ld-profile" class="section level2">
<h2>LD Profile</h2>
<p>Using an LD profile allows the user to adjust for variable recombination rates along the chromosome. Here is the example LD profile provided with the zalpha R package:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">LDprofile</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co">#&gt;       bin        rsq        sd    Beta_a    Beta_b</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="co">#&gt; 1  0.0000 0.12214545 0.2275545 0.2764342 1.8116558</span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co">#&gt; 2  0.0001 0.09335562 0.2197797 0.2708984 2.0267642</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="co">#&gt; 3  0.0002 0.12218997 0.2370013 0.2698494 1.6785461</span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="co">#&gt; 4  0.0003 0.09042594 0.2005840 0.2639042 2.2719719</span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="co">#&gt; 5  0.0004 0.09846861 0.2415291 0.2498579 1.5550545</span></a>
<a class="sourceLine" id="cb4-8" title="8"><span class="co">#&gt; 6  0.0005 0.05234892 0.1645840 0.2734530 3.5077770</span></a>
<a class="sourceLine" id="cb4-9" title="9"><span class="co">#&gt; 7  0.0006 0.09849803 0.2171552 0.2805981 2.0719602</span></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="co">#&gt; 8  0.0007 0.09234729 0.2185910 0.2729321 1.8642312</span></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="co">#&gt; 9  0.0008 0.05612510 0.1463234 0.3270302 4.5627156</span></a>
<a class="sourceLine" id="cb4-12" title="12"><span class="co">#&gt; 10 0.0009 0.05799673 0.1569512 0.2875387 3.8010222</span></a>
<a class="sourceLine" id="cb4-13" title="13"><span class="co">#&gt; 11 0.0010 0.06451333 0.1803580 0.2695071 2.7318059</span></a>
<a class="sourceLine" id="cb4-14" title="14"><span class="co">#&gt; 12 0.0011 0.07202593 0.1980737 0.2575224 2.2259595</span></a>
<a class="sourceLine" id="cb4-15" title="15"><span class="co">#&gt; 13 0.0012 0.10457653 0.2452326 0.2527777 1.5974515</span></a>
<a class="sourceLine" id="cb4-16" title="16"><span class="co">#&gt; 14 0.0013 0.05750545 0.1681630 0.2854224 3.3140481</span></a>
<a class="sourceLine" id="cb4-17" title="17"><span class="co">#&gt; 15 0.0014 0.09774452 0.2388637 0.1924497 0.6386457</span></a>
<a class="sourceLine" id="cb4-18" title="18"><span class="co">#&gt; 16 0.0015 0.06229074 0.1752179 0.1791416 0.6853134</span></a>
<a class="sourceLine" id="cb4-19" title="19"><span class="co">#&gt; 17 0.0016 0.08488753 0.1917311 0.3031776 2.7157927</span></a>
<a class="sourceLine" id="cb4-20" title="20"><span class="co">#&gt; 18 0.0017 0.08160874 0.2037504 0.2639457 2.1465406</span></a>
<a class="sourceLine" id="cb4-21" title="21"><span class="co">#&gt; 19 0.0018 0.08745139 0.2037958 0.2704832 2.2651764</span></a>
<a class="sourceLine" id="cb4-22" title="22"><span class="co">#&gt; 20 0.0019 0.07123330 0.1840094 0.2810918 2.8468435</span></a>
<a class="sourceLine" id="cb4-23" title="23"><span class="co">#&gt; 21 0.0020 0.09485261 0.2191376 0.2723791 1.9259026</span></a>
<a class="sourceLine" id="cb4-24" title="24"><span class="co">#&gt; 22 0.0021 0.05804671 0.1458408 0.3207629 4.4316165</span></a>
<a class="sourceLine" id="cb4-25" title="25"><span class="co">#&gt; 23 0.0022 0.06447594 0.1502141 0.3368500 4.2842122</span></a>
<a class="sourceLine" id="cb4-26" title="26"><span class="co">#&gt; 24 0.0023 0.08147056 0.2012367 0.2690378 2.2633659</span></a>
<a class="sourceLine" id="cb4-27" title="27"><span class="co">#&gt; 25 0.0024 0.09434107 0.2250389 0.2557325 1.8280552</span></a>
<a class="sourceLine" id="cb4-28" title="28"><span class="co">#&gt; 26 0.0025 0.07046571 0.1831713 0.2857604 2.8830237</span></a>
<a class="sourceLine" id="cb4-29" title="29"><span class="co">#&gt; 27 0.0026 0.08397797 0.1926024 0.2900191 2.4698181</span></a>
<a class="sourceLine" id="cb4-30" title="30"><span class="co">#&gt; 28 0.0027 0.05834056 0.1662758 0.3033592 3.2711990</span></a>
<a class="sourceLine" id="cb4-31" title="31"><span class="co">#&gt; 29 0.0028 0.06702507 0.1662532 0.2933794 3.2574873</span></a>
<a class="sourceLine" id="cb4-32" title="32"><span class="co">#&gt; 30 0.0029 0.05820796 0.1723149 0.2682267 2.8738054</span></a>
<a class="sourceLine" id="cb4-33" title="33"><span class="co">#&gt; 31 0.0030 0.09507890 0.2085120 0.2716050 2.1487500</span></a>
<a class="sourceLine" id="cb4-34" title="34"><span class="co">#&gt; 32 0.0031 0.04551497 0.1239696 0.3296394 5.8488772</span></a>
<a class="sourceLine" id="cb4-35" title="35"><span class="co">#&gt; 33 0.0032 0.04241460 0.1352978 0.3349360 5.5737334</span></a>
<a class="sourceLine" id="cb4-36" title="36"><span class="co">#&gt; 34 0.0033 0.10255730 0.2259408 0.2718446 1.9065634</span></a>
<a class="sourceLine" id="cb4-37" title="37"><span class="co">#&gt; 35 0.0034 0.05181171 0.1523572 0.2978946 4.0344464</span></a>
<a class="sourceLine" id="cb4-38" title="38"><span class="co">#&gt; 36 0.0035 0.06537539 0.1633711 0.2937305 3.4617464</span></a>
<a class="sourceLine" id="cb4-39" title="39"><span class="co">#&gt; 37 0.0036 0.07133690 0.1728133 0.2845848 3.0456476</span></a>
<a class="sourceLine" id="cb4-40" title="40"><span class="co">#&gt; 38 0.0037 0.09034151 0.2365844 0.2438361 1.6296772</span></a>
<a class="sourceLine" id="cb4-41" title="41"><span class="co">#&gt; 39 0.0038 0.06661469 0.1718022 0.2842834 3.1988517</span></a>
<a class="sourceLine" id="cb4-42" title="42"><span class="co">#&gt; 40 0.0039 0.11322964 0.2325874 0.2031107 0.6843425</span></a>
<a class="sourceLine" id="cb4-43" title="43"><span class="co">#&gt; 41 0.0040 0.10068963 0.2067405 0.2918418 2.1743057</span></a>
<a class="sourceLine" id="cb4-44" title="44"><span class="co">#&gt; 42 0.0041 0.09924437 0.2321804 0.2601480 1.7887389</span></a>
<a class="sourceLine" id="cb4-45" title="45"><span class="co">#&gt; 43 0.0042 0.07122869 0.1813322 0.2701038 2.7201233</span></a>
<a class="sourceLine" id="cb4-46" title="46"><span class="co">#&gt; 44 0.0043 0.11335340 0.2081721 0.2869211 2.0950029</span></a>
<a class="sourceLine" id="cb4-47" title="47"><span class="co">#&gt; 45 0.0044 0.11286222 0.2357003 0.2679826 1.6981865</span></a>
<a class="sourceLine" id="cb4-48" title="48"><span class="co">#&gt; 46 0.0045 0.05429260 0.1622758 0.2940277 3.7098450</span></a>
<a class="sourceLine" id="cb4-49" title="49"><span class="co">#&gt; 47 0.0046 0.07505181 0.1992234 0.2679613 2.3091843</span></a>
<a class="sourceLine" id="cb4-50" title="50"><span class="co">#&gt; 48 0.0047 0.08873456 0.1996523 0.2754293 2.3102141</span></a>
<a class="sourceLine" id="cb4-51" title="51"><span class="co">#&gt; 49 0.0048 0.06982331 0.1902250 0.2603511 2.4806350</span></a>
<a class="sourceLine" id="cb4-52" title="52"><span class="co">#&gt; 50 0.0049 0.07837201 0.1944029 0.2745399 2.5207091</span></a></code></pre></div>
<p>The LD (linkage disequilibrium) profile contains data about the expected correlation between SNPs given the genetic distance between them. This could be generated using a simulated chromosome where the genetic distances are known, after which the statistics can be calculated. The columns are:</p>
<ul>
<li><p>bin: this is the lower bound of the bin. In this example, row 1 would include any SNPs greater than or equal to 0 but less than 0.0001 centimorgans apart (or whatever measure of genetic distance applicable for the user).</p></li>
<li><p>rsq: the expected r<sup>2</sup> value for SNPs whose genetic distance between them falls within the bin.</p></li>
<li><p>sd: the standard deviation of r<sup>2</sup> for the bin.</p></li>
<li><p>Beta_a: the first shape of the Beta distribution fitted to this bin. The R function fitdist can be used to estimate the Beta parameters.</p></li>
<li><p>Beta_b: the second shape of the Beta distribution.</p></li>
</ul>
<p>For example, if we assume the bins are in centimorgans, and we know two SNPs are 0.00015 cM apart, the LDprofile tells us that we expect the r<sup>2</sup> value to be 0.093, with a standard deviation of 0.22 and fits the distribution Beta(0.27,2.03).</p>
<p>For real world data, Jacobs et al. (2016) recommend using distances up to 2 cM assigned to 20,000 bins.</p>
</div>
<div id="zalpha_expected" class="section level2">
<h2>Zalpha_expected</h2>
<p>The expected <span class="math inline">\(Z_{\alpha}\)</span> value (denoted <span class="math inline">\(Z_{\alpha}^{E[r^2]}\)</span>) can be calculated for a chromosome given an LD profile and the genetic distances between each SNP in the chromosome. Instead of calculating the r<sup>2</sup> values between SNPs, the function works out the genetic distance between them, finds the bin in the LD profile that the genetic distance falls into, and reads out the expected r<sup>2</sup> value. The function then calculates <span class="math inline">\(Z_{\alpha}\)</span> as normal.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">Zalpha_expected</span>(snps<span class="op">$</span>positions, <span class="dv">3000</span>, snps<span class="op">$</span>distances, LDprofile<span class="op">$</span>bin, LDprofile<span class="op">$</span>rsq)</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="co">#&gt; $position</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="co">#&gt;  [1]  100  200  300  400  500  600  700  800  900 1000 1100 1200 1300 1400 1500</span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="co">#&gt; [16] 1600 1700 1800 1900 2000</span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="co">#&gt; $Zalpha_expected</span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="co">#&gt;  [1]         NA         NA         NA         NA 0.08633502 0.08169169</span></a>
<a class="sourceLine" id="cb5-8" title="8"><span class="co">#&gt;  [7] 0.07981817 0.08104324 0.08134506 0.08015626 0.07984135 0.08082988</span></a>
<a class="sourceLine" id="cb5-9" title="9"><span class="co">#&gt; [13] 0.08263229 0.08040794 0.07822704 0.08289555         NA         NA</span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="co">#&gt; [19]         NA         NA</span></a></code></pre></div>
<p>Once <span class="math inline">\(Z_{\alpha}^{E[r^2]}\)</span> has been calculated, it can be combined with the <span class="math inline">\(Z_{\alpha}\)</span> results to adjust for recombination, for example by computing <span class="math inline">\(Z_{\alpha}\)</span> - <span class="math inline">\(Z_{\alpha}^{E[r^2]}\)</span> or <span class="math inline">\(Z_{\alpha}\)</span>/<span class="math inline">\(Z_{\alpha}^{E[r^2]}\)</span>.</p>
<p>Other functions that take into account variable recombination rates are Zalpha_rsq_over_expected, Zalpha_log_rsq_over_expected, Zalpha_Zscore, and Zalpha_BetaCDF.</p>
</div>
<div id="zbeta" class="section level2">
<h2>Zbeta</h2>
<p>The Zbeta function works in exactly the same way as the Zalpha function, but evaluates correlations between SNPs on either side of the target locus, rather than each side separately. It is useful to use the <span class="math inline">\(Z_{\beta}\)</span> statistic in conjunction with the <span class="math inline">\(Z_{\alpha}\)</span> statistic, as they behave differently depending on how close to fixation the sweep is. For example, while a sweep is in progress both <span class="math inline">\(Z_{\alpha}\)</span> and <span class="math inline">\(Z_{\beta}\)</span> would be higher than other areas of the chromosome without a sweep present. However, when a sweep reaches near-fixation, <span class="math inline">\(Z_{\beta}\)</span> would decrease whereas <span class="math inline">\(Z_{\alpha}\)</span> would remain high. Combining <span class="math inline">\(Z_{\alpha}\)</span> and <span class="math inline">\(Z_{\beta}\)</span> into new statistics such as <span class="math inline">\(Z_{\alpha}\)</span>/<span class="math inline">\(Z_{\beta}\)</span> is one way of analysing this.</p>
</div>
<div id="zalpha_all" class="section level2">
<h2>Zalpha_all</h2>
<p>Zalpha_all is the recommended function for using this package. It will run all the statistics included in the package (<span class="math inline">\(Z_{\alpha}\)</span> and <span class="math inline">\(Z_{\beta}\)</span> variations), so the user does not have to run multiple functions to achieve all the statistics they want. The function will only calculate the statistics it has been given the appropriate inputs for, so it is flexible.</p>
<p>For example, this code will only run Zalpha, Zbeta and the two diversity statistics LR and L_plus_R, as an LDprofile was not supplied:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">Zalpha_all</span>(snps<span class="op">$</span>positions,<span class="dv">3000</span>,<span class="kw">as.matrix</span>(snps[,<span class="dv">3</span><span class="op">:</span><span class="dv">12</span>]))</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="co">#&gt; $position</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="co">#&gt;  [1]  100  200  300  400  500  600  700  800  900 1000 1100 1200 1300 1400 1500</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="co">#&gt; [16] 1600 1700 1800 1900 2000</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="co">#&gt; $LR</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="co">#&gt;  [1] NA NA NA NA 60 70 78 84 88 90 90 88 84 78 70 60 NA NA NA NA</span></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="co">#&gt; $L_plus_R</span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="co">#&gt;  [1]  NA  NA  NA  NA 111 101  93  87  83  81  81  83  87  93 101 111  NA  NA  NA</span></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="co">#&gt; [20]  NA</span></a>
<a class="sourceLine" id="cb6-12" title="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="co">#&gt; $Zalpha</span></a>
<a class="sourceLine" id="cb6-14" title="14"><span class="co">#&gt;  [1]         NA         NA         NA         NA 0.09893585 0.10944106</span></a>
<a class="sourceLine" id="cb6-15" title="15"><span class="co">#&gt;  [7] 0.11602964 0.11215782 0.12419556 0.12962040 0.12583275 0.11980489</span></a>
<a class="sourceLine" id="cb6-16" title="16"><span class="co">#&gt; [13] 0.10802033 0.12064462 0.10873917 0.10267168         NA         NA</span></a>
<a class="sourceLine" id="cb6-17" title="17"><span class="co">#&gt; [19]         NA         NA</span></a>
<a class="sourceLine" id="cb6-18" title="18"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-19" title="19"><span class="co">#&gt; $Zbeta</span></a>
<a class="sourceLine" id="cb6-20" title="20"><span class="co">#&gt;  [1]        NA        NA        NA        NA 0.1280042 0.1298619 0.1219965</span></a>
<a class="sourceLine" id="cb6-21" title="21"><span class="co">#&gt;  [8] 0.1071535 0.1124896 0.1121871 0.1033178 0.1185118 0.1212802 0.1281512</span></a>
<a class="sourceLine" id="cb6-22" title="22"><span class="co">#&gt; [15] 0.1275420 0.1442328        NA        NA        NA        NA</span></a></code></pre></div>
<p>Supplying an LDprofile will result in more of the statistics being calculated.</p>
<p>There are many ways that the resulting statistics can be combined to give new insights into the data, see Jacobs et al. (2016).</p>
</div>
<div id="identifying-regions-under-selection" class="section level2">
<h2>Identifying regions under selection</h2>
<p>To find candidate regions for selection, first calculate the statistics across the chromosome, including any combined statistics that may be of interest. It is then suggested to find the maximum value for windows of around 200 Kb for each statistic (minimum values for the diversity statistics). Any regions which are outliers compared to the rest of the chromosome could be considered candidates and can be investigated further.</p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Jacobs, G.S., T.J. Sluckin, and T. Kivisild, <em>Refining the Use of Linkage Disequilibrium as a Robust Signature of Selective Sweeps.</em> Genetics, 2016. <strong>203</strong>(4): p. 1807</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
